<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Valentina Erastova" /><link rel="canonical" href="https://erastova-group.github.io/ClayCode/userguide/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>User Guide - ClayCode</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "User Guide";
        var mkdocs_page_input_path = "userguide.md";
        var mkdocs_page_url = "/ClayCode/userguide/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/bash.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> ClayCode
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../start/">Quick Start</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Documentation</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">User Guide</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#dependencies">Dependencies</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#data-files">Data files</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#clay-composition">Clay Composition</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#input-parameters">Input Parameters</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#output">Output</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#adding-unit-cells">Adding Unit Cells</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#example-ucgro-and-ucitp">Example UC.gro and UC.itp</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Modules</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../builder/">ClayCode.builder</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../siminp/">ClayCode.simpinp</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >INPUT files</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../YAML/">YAML</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../CSV/">CSV</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../output/">OUTPUT files</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutorials</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../tutorials/">Tutorials</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Clays</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../mmt/">Montmorillonite</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../imt/">Illite</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../pyr/">Pyrophylite</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../nont/">Nontronite</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../swa/">Fe-smectite</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../kao/">Kaolinite</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../ldh/">LDH</a>
                </li>
    </ul>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../developers/">Developers Guide</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">ClayCode</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Documentation</li>
      <li class="breadcrumb-item active">User Guide</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/Erastova-group/ClayCode/edit/master/docs/userguide.md">Edit on ClayCode</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="user-guide">User Guide</h1>
<h2 id="dependencies">Dependencies</h2>
<p>ClayCode is compatible with UNIX operating systems. </p>
<p>It relies on the following python libraries: NumPy (1.21.2), Pandas (1.3.4) and MDAnalysis (2.0.0).</p>
<p>Furthermore, solvent molecules and ions are added as GROMACS subprocesses. Therefore, in order to execute builder, a local GROMACS installation is required.</p>
<h2 id="data-files">Data files</h2>
<p>The data files store information necessary to construct the clay structures for MD simulation. </p>
<p>The files are stored within <code>ClayCode/data/</code> directory:</p>
<pre><code class="language-shell">ClayCode
│
...
│
└── data
   ├── FF
   │    └── ClayFF_Fe.ff
   │    └── Ions.ff
   ├── MDP
   ├── UCS
   │   ├── D11
   │   ├── D21
   │   └── LDH31
   └── user


</code></pre>
<p>where:</p>
<ul>
<li><code>data/FF</code> contains force fields files, as dictated by GROMACS format, currently included:
        -  ClayFF force field<sup id="fnref:Cygan2004"><a class="footnote-ref" href="#fn:Cygan2004">1</a></sup> (with added Fe parameters based on personal communication with Andrey Kalinichev) in a directory <code>ClayFF_Fe.ff</code>, and
        -  Ions by Pengfei Li <sup id="fnref:li2016advances"><a class="footnote-ref" href="#fn:li2016advances">2</a></sup> in <code>Ions.ff</code>, default is IOD-type, HFE and CN also included.</li>
<li><code>data/UCS</code> contains unit cell structures in .GRO format and their corresponding .ITP, topology assigned to ClayFF force field. The files are grouped per type, where <code>D21</code> us dioctohedral 2:1 clay, <code>D11</code> is dioctohedral 1:1 and <code>LDH31</code> is a layered double hydroxide. To include new UCs, see <a href="#Adding_UC">Adding Unit Cells</a>.</li>
<li><code>data/MDP</code> contains GROMACS version-specific .MDP files for energy minimisation and equilibration.</li>
<li><code>data/user</code> reserved for user files.</li>
</ul>
<h2 id="clay-composition">Clay Composition</h2>
<p>The file in .CSV format containing the reduced unit cell structure, including partial atomic occupancies, charge balancing ions and layer charges for each clay listed.</p>
<p>See full details in the <a href="../CSV/">Input files: CSV</a></p>
<p>It is also possible to supply clay composition within the <a href="../YAML/">.YAML</a> input only. See <a href="../pyr/">Pyrophyllite</a> as an example</p>
<h2 id="input-parameters">Input Parameters</h2>
<p>System specification for the set-up are done given in .YAML format. See full details in <a href="../YAML/">Input files: YAML</a></p>
<p>Parameters</p>
<p><img src="https://raw.githubusercontent.com/Erastova-group/ClayCode/main/docs/assets/input_illustration.png" height="600"></p>
<h2 id="output">Output</h2>
<p>See <a href="../output/">Output files</a></p>
<hr />
<p><a name="Adding_UC"></a></p>
<h2 id="adding-unit-cells">Adding Unit Cells</h2>
<p>Use of ClayCode should not be dictated only by the Unite Cells provided with this release. To add a new unit cell, one needs to:</p>
<p>1 - Obtain a crystal structure. <br/>
We recommend downloading .cif from the <a href="http://rruff.geo.arizona.edu/AMS/amcsd.php">American Mineralogist Crystal Structure Database</a>.</p>
<p>2 - Convert it to full occupancy expanded structure .gro (or .pdb). <br/>
We recommend using one of the the following <a href="http://openbabel.org/wiki/Main_Page">OpenBabel</a>, <a href="https://avogadro.cc">Avogadro</a><sup id="fnref:hanwell2012avogadro"><a class="footnote-ref" href="#fn:hanwell2012avogadro">3</a></sup> (not Avogadro2) or <a href="https://www.ccdc.cam.ac.uk/solutions/software/mercury/">Mercury</a> by CCDC (licence needed). We prefer Avogadro.</p>
<p>3 - Manually rename the atoms in the .gro to have unique names. <br/></p>
<p>4 - Create an include topology file (.itp), please reffer to <a href="https://manual.gromacs.org/current/reference-manual/topologies/topology-file-formats.html">GROMACS manual</a>. <br/>
Assign each unique atom name in the .gro to an atom type, as given in the <code>ClayFF.ff/atomtypes.atp</code>:</p>
<pre><code>hw      1.008        ; water hydrogen
ho      1.008        ; hydroxyl hydrogen
ow      16.00        ; water hydrogen
oh      16.00        ; hydroxyl oxygen
ob      16.00        ; bridging oxygen
obos    16.00        ; bridging oxygen with octahedral substitution
obts    16.00        ; bridging oxygen with tetrahedral substitution
obss    16.00        ; bridging oxygen with double substitution 
ohs     16.00        ; hydroxyl oxygen with substitution
st      28.09        ; tetrahedral silicon
ao      26.98        ; octahedral aluminum
at      26.98        ; tetrahedral aluminum
mgo     24.31        ; octahedral magnesium
mgh     24.31        ; hydroxide magnesium
cao     40.08        ; octahedral calcium
cah     40.08        ; hydroxide calcium 
feo     55.85        ; octahedral iron (III)
fe2     55.85        ; octahedral iron (II)
lio     6.941        ; octahedral lithium
</code></pre>
<h3 id="example-ucgro-and-ucitp">Example UC.gro and UC.itp</h3>
<p>A unit cell for Dioctohedral 1:1 (Kaolinite-type) with stocheometery <code>D101.gro</code>:</p>
<pre><code>Dioctahedral 1:1 unit cell  1
   34
    1D101   AO1    1   0.061   0.433   0.332
    1D101   AO2    2   0.321   0.283   0.332
    1D101   AO3    3   0.320   0.880   0.332
    1D101   AO4    4   0.064   0.730   0.332
    1D101   ST1    5   0.237   0.749   0.065
    1D101   ST2    6   0.500   0.594   0.067
    1D101   ST3    7   0.493   0.301   0.065
    1D101   ST4    8   0.244   0.147   0.067
    1D101   OB1    9   0.225   0.751   0.226
    1D101   OB2   10   0.255   0.135   0.227
    1D101   OB3   11   0.258   0.000   0.000
    1D101   OB4   12   0.359   0.651   0.021
    1D101   OB5   13   0.360   0.236   0.001
    1D101   OB6   14   0.480   0.304   0.226
    1D101   OB7   15   0.510   0.582   0.227
    1D101   OB8   16   0.002   0.447   0.000
    1D101   OB9   17   0.100   0.204   0.021
    1D101  OB10   18   0.104   0.683   0.001
    1D101   OH1   19   0.223   0.413   0.232
    1D101   OH2   20   0.123   0.581   0.433
    1D101   OH3   21   0.164   0.855   0.431
    1D101   OH4   22   0.162   0.306   0.434
    1D101   OH5   23   0.480   0.860   0.232
    1D101   OH6   24   0.379   0.134   0.433
    1D101   OH7   25   0.420   0.408   0.431
    1D101   OH8   26   0.420   0.753   0.434
    1D101   HO1   27   0.530   0.940   0.233
    1D101   HO2   28   0.410   0.129   0.527
    1D101   HO3   29   0.400   0.434   0.522
    1D101   HO4   30   0.137   0.264   0.519
    1D101   HO5   31   0.272   0.497   0.233
    1D101   HO6   32   0.150   0.576   0.527
    1D101   HO7   33   0.136   0.880   0.522
    1D101   HO8   34   0.400   0.712   0.519
   0.51540   0.89420   0.63910
</code></pre>
<p>and corresponding <code>D101.itp</code>:</p>
<pre><code>[ moleculetype ]
; name      nrexcl
   D101     1

[ atoms ]
;   nr       type  resnr residue  atom   cgnr     charge       mass  typeB    chargeB      massB
; residue   1  KAO rtp  KAO  q  0.0
     1         ao      1     D101   AO1      1      1.575      26.98   ;
     2         ao      1     D101   AO2      2      1.575      26.98   ;
     3         ao      1     D101   AO3      3      1.575      26.98   ;
     4         ao      1     D101   AO4      4      1.575      26.98   ;
     5         st      1     D101   ST1      5        2.1      28.09   ;
     6         st      1     D101   ST2      6        2.1      28.09   ;
     7         st      1     D101   ST3      7        2.1      28.09   ;
     8         st      1     D101   ST4      8        2.1      28.09   ;
     9         ob      1     D101   OB1      9      -1.05         16   ;
    10         ob      1     D101   OB2     10      -1.05         16   ;
    11         ob      1     D101   OB3     11      -1.05         16   ;
    12         ob      1     D101   OB4     12      -1.05         16   ;
    13         ob      1     D101   OB5     13      -1.05         16   ;
    14         ob      1     D101   OB6     14      -1.05         16   ;
    15         ob      1     D101   OB7     15      -1.05         16   ;
    16         ob      1     D101   OB8     16      -1.05         16   ;
    17         ob      1     D101   OB9     17      -1.05         16   ;
    18         ob      1     D101  OB10     18      -1.05         16   ;
    19         oh      1     D101   OH1     19      -0.95         16   ;
    20         oh      1     D101   OH2     20      -0.95         16   ;
    21         oh      1     D101   OH3     21      -0.95         16   ;
    22         oh      1     D101   OH4     22      -0.95         16   ;
    23         oh      1     D101   OH5     23      -0.95         16   ;
    24         oh      1     D101   OH6     24      -0.95         16   ;
    25         oh      1     D101   OH7     25      -0.95         16   ;
    26         oh      1     D101   OH8     26      -0.95         16   ;
    27         ho      1     D101   HO1     27      0.425      1.008   ;
    28         ho      1     D101   HO2     28      0.425      1.008   ;
    29         ho      1     D101   HO3     29      0.425      1.008   ;
    30         ho      1     D101   HO4     30      0.425      1.008   ;
    31         ho      1     D101   HO5     31      0.425      1.008   ;
    32         ho      1     D101   HO6     32      0.425      1.008   ;
    33         ho      1     D101   HO7     33      0.425      1.008   ;
    34         ho      1     D101   HO8     34      0.425      1.008   ;

[ bonds ]
; i j   funct   length  force.c.                    
19 31   1     0.1    463532.808
20 32   1     0.1    463532.808
21 33   1     0.1    463532.808
22 30   1     0.1    463532.808
23 27   1     0.1    463532.808
24 28   1     0.1    463532.808
25 29   1     0.1    463532.808
26 34   1     0.1    463532.808
</code></pre>
<div class="footnote">
<hr />
<ol>
<li id="fn:Cygan2004">
<p>Randall T. Cygan, Jian Jie Liang, and Andrey G. Kalinichev. Molecular models of hydroxide, oxyhydroxide, and clay phases and the development of a general force field. <em>Journal of Physical Chemistry B</em>, 108(4):1255–1266, 1 2004. <a href="https://doi.org/10.1021/JP0363287">doi:10.1021/JP0363287</a>.&#160;<a class="footnote-backref" href="#fnref:Cygan2004" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:li2016advances">
<p>Pengfei Li. <em>Advances in metal ion modeling</em>. Michigan State University, 2016.&#160;<a class="footnote-backref" href="#fnref:li2016advances" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:hanwell2012avogadro">
<p>Marcus D Hanwell, Donald E Curtis, David C Lonie, Tim Vandermeersch, Eva Zurek, and Geoffrey R Hutchison. Avogadro: an advanced semantic chemical editor, visualization, and analysis platform. <em>Journal of cheminformatics</em>, 4(1):1–17, 2012. <a href="https://doi.org/10.1186/1758-2946-4-17">doi:10.1186/1758-2946-4-17</a>.&#160;<a class="footnote-backref" href="#fnref:hanwell2012avogadro" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
</ol>
</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../start/" class="btn btn-neutral float-left" title="Quick Start"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../builder/" class="btn btn-neutral float-right" title="ClayCode.builder">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/Erastova-group/ClayCode" class="fa fa-code-fork" style="color: #fcfcfc"> ClayCode</a>
        </span>
    
    
      <span><a href="../start/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../builder/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
